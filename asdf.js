window.onload = function () {

    // words 중복 제거 & 가나다순 정렬
    function updatewords() {
        // 중복 제거
        words = [...new Set([...wordsorigin, ...wordsnew])]
        // 비었을 시 거르기
        .filter(a => a !== '')
        // 가나다순 정렬
        .sort();
    }
    // juje 가져오기
    function updatejuje() {
        var a = inputdocument.value.match(/(?<=:).+(?=\]\]\[)/);
        var b = inputjuje.value;

        juje = !a ? b : b ? b : a;
        juje2 = juje == '분홍꽃' ? '분홍꽃(주제)' : juje;
        juje3 = juje == '분홍꽃' ? '분홍꽃(주제)|분홍꽃' : juje;
    }
    // 목록 업데이트
    function updatemokrok() {
        jujejunche();
        jujegim();
    }
    // 주제 전체 단어 목록 만들기
    function jujejunche() {
        // 단어 없을시 비우기
        if (!words.length) {
            showjujejunche.value = "";
            return;
        };

        // 셀 안에 든 단어 형태
        var b = {};

        for (let i = 0; i < words.length; i++) {
            // 단어
            var c = words[i];
            // 단어의 앞 글자
            var d = c.charAt();

            if (b[d]) {
                // 셀 안에 든 단어 형태로 넣기
                b[d].push(`|-\n| ${c.length} || [[${JUJE.includes(c) ? `${c}(단어)|${c}` : c}]]`);
            } else {
                // 생성 & 셀 안에 든 단어 형태로 만들기
                b[d] = [`|-\n| ${c.length} || [[${JUJE.includes(c) ? `${c}(단어)|${c}` : c}]]`];
            };
        };

        var f = Object.keys(b)
        // 문단 만들기
        .map(a => `=== ${a} ===\n{| class="wikitable sortable" style="text-align: center;"\n! width="50" | 길이 !! 단어\n${b[a].join("\n")}\n|}`)
        // 문자열로 변환
        .join("\n\n");

        // 문서 형태로 만들기
        showjujejunche.value = `[[분류:${juje}]][[분류:전체 단어 목록]]\n{{상위 문서|${juje2}}}\n== 개요 ==\n[[${juje3}]] 주제의 전체 단어 목록이다.\n\n== 목록 ==\n\n${f}`;
    }
    // 주제 긴 단어 목록 만들기
    function jujegim() {
        // 9글자 이상 단어 가져오기
        var a = words.filter(a => a.length >= 9);
        // 9글자 이상 단어 없을 시 비우기
        if (!a.length) {
            showjujegim.value = "";
            return;
        };

        var b = a
        // 긴 순 정렬
        .sort((a, b) => b.length - a.length)
        // 셀 안에 든 단어 형태로 만들기
        .map(a => `|-\n| ${a.length} || [[${JUJE.includes(a) ? `${a}}(단어)|${a}` : a}]]`)
        // 문자열로 변환
        .join("\n");

        // 문서 형태로 만들기
        showjujegim.value = `[[분류:${juje}]][[분류:긴 단어 목록]]\n{{상위 문서|${juje2}}}\n== 개요 ==\n[[${juje3}]] 주제의 긴 단어 목록이다.\n\n== 목록 ==\n{| class="wikitable sortable" style="text-align: center;"\n! width="50" | 길이 !! 단어\n${b}\n|}`
    }

    const inputdocument = document.getElementById("inputdocument");
    const inputwords = document.getElementById("inputwords");
    const inputjuje = document.getElementById("inputjuje");
    const showjujejunche = document.getElementById("showjujejunche");
    const showjujegim = document.getElementById("showjujegim");
    const copyjujejunche = document.getElementById("copyjujejunche");
    const copyjujegim = document.getElementById("copyjujegim");

    const JUJE = [
        '대문',
        '분끄위키',
        '파일올리기',
        '토론장',
        '주제',
        '경제',
        '고적',
        '공업',
        '교육',
        '교통',
        '농업',
        '문학',
        '물리',
        '미술',
        '동물',
        '사회',
        '생물',
        '수학',
        '식물',
        '언어',
        '역사',
        '운동',
        '음악',
        '지리',
        '지명',
        '천문',
        '컴퓨터',
        '화학',
        '가톨릭',
        '건설',
        '고유',
        '광업',
        '군사',
        '기계',
        '기독교',
        '논리',
        '민속',
        '법률',
        '불교',
        '수산',
        '수공',
        '심리',
        '약학',
        '언론',
        '연영',
        '예술',
        '의학',
        '인명',
        '전기',
        '정치',
        '종교',
        '책명',
        '철학',
        '출판',
        '통신',
        '한의학',
        '항공',
        '해양',
        '디지몬',
        '요괴워치',
        '포켓몬스터',
        '니세코이',
        '도라에몽',
        '빙과',
        '오레이모',
        '원피스',
        '유루유리',
        '간식',
        '게임',
        '기업',
        '뮤지컬',
        '속담',
        '신조어',
        '유명인',
        '직업',
        '캐릭터',
        '학교',
        '공항',
        '마인크래프트',
        '메이플스토리',
        '모두의마블',
        '분홍꽃',
        '브롤스타즈',
        '사이퍼즈',
        '세븐나이츠',
        '스타크래프트',
        '엘소드',
        '오버워치',
        '원신',
        '좀비고등학교',
        '카트라이더',
        '쿠키런',
        '테일즈런너',
        '하스스톤',
        '소설',
        '에세이',
        '웹툰',
        '분홍봇',
        '용어',
        '아이템',
    ];

    let words = [];
    let wordsorigin = [];
    let wordsnew = [];
    let juje = '';
    let juje2 = '';
    let juje3 = '';

    inputdocument.onkeyup = function () {
        // 대괄호 안 문자열을 배열로 만들기
        var a = inputdocument.value.match(/(?<=\| \[\[).+(?=\]\])/g);

        wordsorigin = a
        // 단어 문서 변형
        ? a.map(a => a.includes('(단어)') ? a.substr(0, a.indexOf('(단어)')) : a)
        // 단어가 없을 시 비우기
        : [];

        updatewords();
        updatejuje();
        updatemokrok();
    };
    inputwords.onkeyup = function () {
        // 문자열을 배열로 만들기
        wordsnew = inputwords.value.split("\n");

        updatewords();
        updatemokrok();
    };
    inputjuje.onkeyup = function () {
        updatejuje();
        updatemokrok();
    };
    copyjujejunche.onclick = function () {
        showjujejunche.select();
        document.execCommand('copy');
    };
    copyjujegim.onclick = function () {
        showjujegim.select();
        document.execCommand('copy');
    };

    console.log(`
$##################################@@@@@@#=;:~~~~~~-------------~!$@@@@@@@@@#######################$
$#################################@@@@@@#=;:~~~~~~---------------~;=#@@@@@@@@######################$
$#################################@@@@@@$!::~~~~~-----------------~:!$@@@@@@@######################$
$#################################@@@@@#*;:~~~~~~-----------------~~~;$@@@@@@######################$
$################################@@@@@@$!::~~~~~--------------------~~!#@@@@@######################$
$################################@@@@@#*;::::~~----------------------~:=#@@@@######################$
$################################@@@@#=*!;::::;:~--------------------~~!#@@@@@#####################$
$###############################@@@@@$=!;::::~~~;:--------------------~;$@@@@@#####################$
$################################@@@$=*;;;;;;!;:~::-------------~~~~~~~:*#@@@@#####################$
$##############################@@@@#==!;;;;:!$$=*;;:~--------~~:::::::::;#@@@@#####################$
$##############################@@@$===;;;;:~:!*=$*!!:------~:::~:~~~~~:;!=@@@@#####################$
$#############################@@@#=;$!;;;;:::::;!;;;;~~~~~~:;;!;;;:;!:~;==@@@@#####################$
$#############################@@@@$*=;;!!!!!::::::::!::~~::;;!;;;;:;!!::=$#@@@#####################$
$#############################@@@#=**;;;!**=$=**!;::;~~~~~;:;;::::~~~~::!$#@#######################$
$@#########################@##@@@$*!;:::::;;!*=*=!;:;~~~~::::;;::::~:~~~;$$@######################@#
$@@########################@@@@@#$!;:~~~~~~::::;!*;:;~~~~:;:;!****!!;;::;$=$#@############@@#####@@#
$##########################@@@@@#=;::~~--~~~~~~::::;:~--~:::!$#$$===*!;::=!;=#############@@@@@@@@@#
#@@########################@@@@@#*:::~------~~~~~::;~~~~~:::;;;;;:::::~~:!*$#@############@@@@@@@@@#
#@@########################@@@@@$!:::~--------~~~~:~~~-~~::~~:::::~~~~~~::!$#@############@@@@@@@@@#
#@@#########################@@@@=;:~~~~---------~:~-----~~:~~~~~~~~~~---~~:*#@#############@@@@@@@@#
#@@@@######################@@@@@*;:~--~:-~-----~:~--~---~~::~~~~~--------~~;##############@@@@@@@@@#
#@@@@######################@@#@#*;~~--,-:~~~~~~:~-~~~----~~::~~~--------~~-:#######################$
#@@@@@##########@@#####@@##@@@@#!;:~---,--~~~~~--~~~~----~~~:~~--------~~--~$######################$
#@@@@@########@@@@@###@@@@@@@@@#!;:~---,,-------~~~~~----~~::::-----~~~----~$######################$
#@@@@@######@@@@@@@@@@@@@@@@@@@$!;:~~---------~~:~-~~--,--~::~:;::~~:~-,--~:$######################$
#@@@@@@##@@@@@@@@@@@@@@@@@@@@@@$!;::~~------~~~::------,----::~~~~~--,,---~:#######################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$!;;:~~~~~~~~::~::~--~~------~;:~-----,,---~;#######################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$;;;::~~~~~:;:~~~::;;::~~~~~~~:;:~~-------~:*#######################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$;;;;::::::;:~~~~~:::::::;;;:~~:;:~~------~:=#######################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$;;;;:::::::::~~~~~~~~~~-~~~-~~::;:~~~~~~~:;$#######################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#;::::::~~~:;!;:~~~-----------~::;::~~~~~::!########################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@!:::::~~~~:;*!;::~~~~--------~:;;;::::::;;!##@#####################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=;:::::~~~~~:!;;;::::~~~~~~~:;;;;::::::;;;*@@@@####################$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=;:::::~~~~~~:;!:::~~:~::::;==!;:::::::;:;$@@@@@@@#@@@@@@@@@@@@@@@#$
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=*!;:::::~~~~~~::;:;:~~~-~~~:!!;:::~~~:::::!#@@@@@@@@@@@@@@@@@@@@@@@#$
#@@@@@@@@@@@@@@@@@@@@@@@@@@#*!!!!!;:::~~~~~~~~::~~~~::~:::::~~~:~~~~~::::=@@@@@@@@@@@@@@@@@@@@@@@@#$
#@@@@@@@@@@@@@@@@@@@@@@@@#*;;:;!!!;:::~~~~~~~~~::~------~~~~~-~:~-~~~:::~;$###@@@@@@@@@@@@#$@@@@@@#$
#@@@@@@@@@@@@@@@@@@@@@@#*;:::~:;;::::::~~~~~~~~~:~~-----~~~~--~~~-~~~:::~~~;!*=$#@@@@@@@@$**=#@@@@#$
#@@@@@@@@@@@@@@@@@@@@@$!:~~~~~~~::~~:::~~~~~~-~~~~~~~---~~~---~~~~~~~::~-~-~;;::;=@@@@@@$!;;!=#@@@#$
#@@@@@@@@@@@@@@@@@@@$!:~~~~~~~~~::~~:::::~~~~---~~~~~~~~------~~~~~~::~---~~:;::~:#@@@@$*;:::!=@@@#=
#@@@@@@@@@@@@@@@@#$!;~~~~-~~~~~~~~~~:;:::::~~-----------------~~~~~::~----~~~:::--*@@@#*;:~~:;*#@@#=
#@@@@@@@@@@@@@@#=!;:~~~:~--~~~~~~~~~:!;::::~~~----------------~~~~::~------~~~::--~=$$*!:~~~~:!#@@#=
#@@@@@@@@@@@@#=!:~~--~~:~~~~~~~~~~-~~!;:::::~~------,,,-------~~~::~-------~~~::-,-~:::~~---~:!$@@#*
#@@@@@@@@@@@$;~~-------~:~~~~~~~~---~!!;::::~~~----,,,,,-----~~~::------,,-~~~::-,------~---~~!$@#$*
#@@@@@@@@@#!~--~-------~~~-~~~~~~---~!!;;::::~~---,,-,,,----~~~::-,----,,,-~~~::-,----~~~---~:!#@#=!
#@@@@@@@#*:~--~---------~~-~~-~~~---~;!;;::::~~~------------~~::-,,---,,,,-~~~:~-----~:~---,-:!##$*;
#@@@@@@$;~~~--------,---~---~~~~-----:!;::::::~~~---------~~:::-,,,,--,,,,--~~~~,----::~-----:!$#=!:
#@@@@@=:-~~-------,,,,---------------:!;:::::::~~~~~----~~~::::-,,,,,-,,,,--~~~-,,--~::~-----~;*=!:~
#@@@#*~-~~-------,,,,,-,-------------~;!;:::::::~~~~~~~~~::::;:-,,,,,-,,,--~~~~~,,-~~~~~~-----~;!;:~
#@#=;--~-------,,,,,,,-,--,----------~:!;:::::::::::::::::::;;~,,,,,,-,,,,-~~~~~,,-~~~~~~---,,-:;;:~
$*;~-~~-------,,,,,,,,-,,-,,----------:;;;:::::::::::::::::;;:-,,,,,,-,,,,--~~~~,,-~~~~~~---,,-~:;:~
:~---~-------,,,,,,,,,-,,-,,----------~:;;::~:::::::::::::;;;~-,,,,,,--,,,--~~~~,,,-~~~~~--,,,-~:::~
    `);
}